[DEBUG ] Reading configuration from /etc/salt/master
[WARNING ] Insecure logging configuration detected! Sensitive data may be logged.
[DEBUG ] Reading configuration from /etc/salt/master
[DEBUG ] jid 20180212145531574568 return from stage1
[DEBUG ] LazyLoaded json.output
{"stage1":{"testdeploy_|-deploy_|-app_|-deploy":{"comment":"READ FROM THE BEGINNING!","name":"app","start_time":"14:55:35.252524","result":true,"duration":7498.668,"__run_num__":0,"changes":{"new":["application repo is /srv/www/app/repo\nrelease path will be /srv/www/app/releases/20180212145535","Current branch in /srv/www/app/repo is staging ","SHA ref changed: 2531a688ee12fc880b7596b6005dd71be5ebc042 -> 6fabc5cc47e849cff77b16034b2fcae3ae61f905","copied /srv/www/app/repo to /srv/www/app/releases/20180212145535","Linked /srv/www/app/shared/config/database.yml -> /srv/www/app/releases/20180212145535/config/database.yml","Linked /srv/www/app/shared/config/unicorn_webpack_precompile.sh -> /srv/www/app/releases/20180212145535/config/unicorn_webpack_precompile.sh","Linked /srv/www/app/shared/config/fluent-logger.yml -> /srv/www/app/releases/20180212145535/config/fluent-logger.yml","Linked shared directories /srv/www/app/shared/node_modules -> /srv/www/app/releases/20180212145535/node_modules","Linked shared directories /srv/www/app/shared/log -> /srv/www/app/releases/20180212145535/log","Linked shared directories /srv/www/app/shared/tmp -> /srv/www/app/releases/20180212145535/tmp","Linked shared directories /srv/www/app/shared/vendor/bundle -> /srv/www/app/releases/20180212145535/vendor/bundle","Linked /srv/www/app/releases/20180212145535 -> /srv/www/app/latest"]},"__id__":"deploy"},"cmd_|-restart_service_|-/etc/init.d/unicorn_app.sh reload_|-run":{"comment":"Command \"/etc/init.d/unicorn_app.sh reload\" run","name":"/etc/init.d/unicorn_app.sh reload","start_time":"15:01:18.192729","result":true,"duration":6592.888,"__run_num__":3,"changes":{"pid":28971,"retcode":0,"stderr":"/etc/init.d/unicorn_app.sh: line 1: return: can only `return' from a function or sourced script","stdout":"/home/front Setting up rvm\nUsing /home/front/.rvm/gems/ruby-2.2.2\nRVM reloaded!\n/var/run/unicorn_app/unicorn.pid\n Reloading unicorn serverBUNDLE_GEMFILE \nCreating new master unicorn thread\nWaiting to see all new and old threads active\nDone\nChecking for old master pid file\nGracefully stopping old master's children\nWaiting for old master thread childs to die... \nDone\nKilling old master\n."},"__id__":"restart_service"},"testdeploy_|-link_current_|-app_|-link_current":{"comment":"","name":"app","start_time":"15:01:18.189127","result":true,"duration":2.27,"__run_num__":2,"changes":{"new":["Linked /srv/www/app/releases/20180212145535 -> /srv/www/app/current"]},"__id__":"link_current"},"cmd_|-releases_cleanup_|-echo `date +%Y-%m-%d_%H:%M:%S`\" DEBUG: The following files are going to be removed:\" >> /srv/www/debug_releases_cleanup; find -maxdepth 1 ! -newer $(ls -tp | tail -n +6 | head -1) ! -name \"$(date --date=\"today\" +%Y%m%d)*\" ! -name \"$(date --date=\"yesterday\" +%Y%m%d)*\" >> /srv/www/debug_releases_cleanup; find -maxdepth 1 ! -newer $(ls -tp | tail -n +6 | head -1) ! -name \"$(date --date=\"today\" +%Y%m%d)*\" ! -name \"$(date --date=\"yesterday\" +%Y%m%d)*\" -exec rm -rf {} \\; >> /srv/www/debug_releases_cleanup ;_|-run":{"comment":"unless execution succeeded","name":"echo `date +%Y-%m-%d_%H:%M:%S`\" DEBUG: The following files are going to be removed:\" >> /srv/www/debug_releases_cleanup; find -maxdepth 1 ! -newer $(ls -tp | tail -n +6 | head -1) ! -name \"$(date --date=\"today\" +%Y%m%d)*\" ! -name \"$(date --date=\"yesterday\" +%Y%m%d)*\" >> /srv/www/debug_releases_cleanup; find -maxdepth 1 ! -newer $(ls -tp | tail -n +6 | head -1) ! -name \"$(date --date=\"today\" +%Y%m%d)*\" ! -name \"$(date --date=\"yesterday\" +%Y%m%d)*\" -exec rm -rf {} \\; >> /srv/www/debug_releases_cleanup ;","start_time":"15:01:24.786410","skip_watch":true,"__id__":"releases_cleanup","duration":19.591,"__run_num__":4,"changes":{},"result":true},"cmd_|-app_post_deploy_local_|-bundle install --deployment --jobs 3 && source ~/.nvm/nvm.sh && nvm install 8.9.3 && nvm use 8.9.3 && npm install && export NODE_ENV=staging && npm run build_|-run":{"comment":"Command \"bundle install --deployment --jobs 3 && source ~/.nvm/nvm.sh && nvm install 8.9.3 && nvm use 8.9.3 && npm install && export NODE_ENV=staging && npm run build\" run","name":"bundle install --deployment --jobs 3 && source ~/.nvm/nvm.sh && nvm install 8.9.3 && nvm use 8.9.3 && npm install && export NODE_ENV=staging && npm run build","start_time":"14:55:42.752789","result":true,"duration":335434.823,"__run_num__":1,"changes":{"pid":28022,"retcode":0,"stderr":"v8.9.3 is already installed.\nnpm WARN deprecated babel-preset-es2015@6.24.1: ðŸ™Œ Thanks for using Babel: we recommend using babel-preset-env now: please read babeljs.io/env to update! \nnpm WARN deprecated npmconf@2.0.9: this package has been reintegrated into npm and is now out of date with respect to npm\nnpm WARN deprecated node-uuid@1.4.8: Use uuid module instead\nnpm notice created a lockfile as package-lock.json. You should commit this file.\nnpm WARN react-iframe@1.1.0 requires a peer of react@>=16.x.x but none is installed. You must install peer dependencies yourself.\nnpm WARN @storybook/react@3.2.19 requires a peer of babel-core@^6.26.0 | ^7.0.0-0 but none is installed. You must install peer dependencies yourself.\nnpm WARN react-test-renderer@15.6.2 requires a peer of react@^15.6.2 but none is installed. You must install peer dependencies yourself.\nnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.1.3 (node_modules/fsevents):\nnpm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.1.3: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\n\b\b\b\b\b\b\b\b\b\b\b\b 0% compile\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 10% 0/1 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 1/1 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 40% 1/2 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 2/2 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 50% 2/3 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 3/3 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 54% 3/4 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 4/4 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 57% 4/5 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 5/5 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 60% 5/6 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 6/6 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 61% 6/7 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 7/7 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 62% 7/8 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 8/8 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 63% 8/9 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 9/9 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 64% 9/10 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b 70% 10/10 build modules\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b","stdout":"Using rake 10.4.2\nUsing abstract_type 0.0.7 || exit 0\n\n\u001b[32mLove nodemon?"},"__id__":"app_post_deploy_local"}}}
